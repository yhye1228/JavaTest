package com.yeong.base;

import java.util.Scanner;

public class Story {
    //추가
    private volatile boolean skipDelay = false;

    public void typeWriter(String text, int delay) {
        for (char c : text.toCharArray()) {
            System.out.print(c);       //줄바꿈없음
            try {
                Thread.sleep(skipDelay ? 0 : delay);
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();//안전하게 인터럽트 처리
                throw new RuntimeException(e);
            }
        }
        System.out.println(); // 한 문장이 끝나면 줄바꿈
    }
    //추가
    public void listenForSkip(){
        new Thread(() -> {
            Scanner sc = new Scanner(System.in);
            sc.nextLine();  //Enter누를 때까지 대기
            skipDelay = true;
        }).start();
    }

    public void initStoryWrite(int delay){
        listenForSkip();    //키 입력 감지 시작
        typeWriter("돌아가신 선제 왕은 어린 소녀를 좋아했다.", delay);
        typeWriter("후사를 많이 남기기 위해 후궁은 커졌고", delay);
        typeWriter("그 커진 후궁에는 일손도 많이 필요했다.", delay);
        System.out.println();
        typeWriter("도성의 유명 유곽 녹청관 안에서", delay);
        typeWriter("약방을 운영하던 뤄먼과 그의 딸 마오마오.", delay);
        typeWriter("소녀들의 인신매매가 쉽게 이루어지는 도성에서", delay);
        typeWriter("마오마오는 일부러 못난 화장을 하고", delay);
        typeWriter("밖으로 돌아다니고 있었다.", delay);
        System.out.println();
        typeWriter("화장이 옅어진 어느 날...", delay);
        typeWriter("인신매매를 당해 후궁의 어딘가로 가게되고,", delay);
        typeWriter("아버지에게 연락도 못할 채", delay);
        typeWriter("빨래터에서 일하게 된다.", delay);
        System.out.println();
        typeWriter("귀부인 중 두 사람이 임신하는 일이 생기지만", delay);
        typeWriter("한 사람은 나날이 야위어가고", delay);
        typeWriter("한 사람은 건강하게 딸을 출산한다.", delay);
        System.out.println();
        typeWriter("글을 읽을 줄 아는 약사로서,", delay);
        typeWriter("후궁 안의 소문을 무시할 수 없었던 마오마오는", delay);
        typeWriter("나서고 싶지 않았지만 사건에 휘말리게 되고", delay);
        typeWriter("...", delay);
        System.out.println();
        typeWriter("그로 인해 천녀(天女)같은 얼굴을 한", delay);
        typeWriter("후궁 관리자 진시와 대면하게 된다.", delay);
    }
}
